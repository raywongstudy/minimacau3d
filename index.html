<!doctype html><html><head><meta charset="utf-8"><title>Mini Macau 3D</title><link rel="icon" type="image/svg+xml" href="images/favicon.svg"><script src="https://kit.fontawesome.com/fdebb7a589.js" crossorigin="anonymous"></script><meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no"><link href="https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css" rel="stylesheet"><script src="https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@turf/turf@7/turf.min.js"></script><script src="data/route_info_data.js"></script><script src="data/bus_coordinates.js"></script><script src="data/station_coordinates.js"></script><script src="data/real_time_camera_data.js"></script><script src="./script/tools/support.js" type="module"></script><script src="./script/AddRouteToMap.js"></script><script src="./script/Add3DFunction.js"></script><script src="./script/AddStationInfo.js"></script><script src="./script/AddCameraData.js"></script><script src="./script/GetUserGps.js"></script><script src="./script/AddBusInMap.js" type="module"></script><script src="./script/AddCarPlay.js"></script><script src="./script/utils/routeUtils.js"></script><script src="./script/AddMapPoint.js" defer="defer"></script><link rel="stylesheet" href="style.css"></head><body><div id="loading-screen"><div class="loading-container"><div class="logo-container"><img src="images/favicon.svg" alt="Mini Macau 3D Logo" class="loading-logo"></div><div class="loading-text">Mini Macau 3D 加載中...</div><div class="loading-spinner"></div></div></div><div id="map"></div><div id="current-time-box"><div id="current-date">2023年1月1日</div><div id="current-time">12:00:00</div></div><div id="map_panel"><a id="fullscreen-button" class="panel_button"><i class="fa-solid fa-expand"></i> </a><a id="toggle-station-button" class="panel_button"><i class="fa-solid fa-location-dot"></i> </a><a id="toggle-route-button" class="panel_button"><i class="fa-solid fa-route"></i> </a><a id="demo-data-button" class="panel_button"><i class="fa-solid fa-floppy-disk"></i> </a><a id="search-route-button" class="panel_button"><i class="fa-solid fa-magnifying-glass"></i> </a><a id="add-map-point-button" class="panel_button"><i class="fa-solid fa-map-pin"></i></a></div><div id="search-modal" class="search-modal"><div class="search-modal-content"><div class="search-box"><div class="route-selection"><select id="route-select"><option value="">請選擇巴士路線...</option></select> <select id="direction-select" disabled="disabled"><option value="">請選擇方向...</option></select></div><div class="search-buttons"><button id="search-confirm">搜尋</button> <button id="search-cancel">關閉</button></div></div></div></div><div id="map-point-modal" class="search-modal"><div class="search-modal-content"><div class="search-box"><h3 style="color:#fff;margin-bottom:15px">選擇巴士路線</h3><div id="route-selector" class="route-selection"></div><div class="percentage-controls"><h4 style="color:#fff;margin-top:15px">百分比位置標記</h4><div class="percentage-slider-container" style="margin-top:10px"><label for="map-percentage" style="color:#fff">百分比位置 (0-100):</label> <input type="range" id="map-percentage" min="0" max="100" value="50" class="percentage-slider" style="background:#363636"> <span id="percentage-value" style="color:#fff;margin-left:10px">50%</span></div><div class="point-buttons" style="margin-top:15px"><button id="add-marker-btn" style="padding:8px 15px;background-color:#464646;color:#fff;border:none;border-radius:4px;cursor:pointer;margin-right:5px">添加標記</button> <button id="clear-markers-btn" style="padding:8px 15px;background-color:#464646;color:#fff;border:none;border-radius:4px;cursor:pointer;margin-right:5px">清除標記</button> <button id="show-all-coords-btn" style="padding:8px 15px;background-color:#464646;color:#fff;border:none;border-radius:4px;cursor:pointer">顯示完整路線</button></div></div><div class="percentage-range-controls" style="margin-top:20px"><h4 style="color:#fff;margin-top:15px">百分比範圍標記</h4><div class="percentage-range-container" style="margin-top:10px;display:flex;align-items:center"><label for="map-start-percentage" style="color:#fff;margin-right:5px">起始:</label> <input type="number" id="map-start-percentage" min="0" max="100" value="0" style="width:60px;padding:5px;background:#363636;color:#fff;border:1px solid #555;border-radius:4px"> <label for="map-end-percentage" style="color:#fff;margin-left:15px;margin-right:5px">結束:</label> <input type="number" id="map-end-percentage" min="0" max="100" value="10" style="width:60px;padding:5px;background:#363636;color:#fff;border:1px solid #555;border-radius:4px"></div><div style="margin-top:10px"><button id="get-percentage-range-btn" style="padding:8px 15px;background-color:#464646;color:#fff;border:none;border-radius:4px;cursor:pointer">顯示範圍</button></div></div><div class="increment-controls" style="margin-top:20px"><h4 style="color:#fff;margin-top:15px">百分比增量標記</h4><div class="increment-container" style="margin-top:10px;display:flex;align-items:center"><label for="map-increment" style="color:#fff;margin-right:5px">增量值:</label> <input type="number" id="map-increment" min="1" max="50" value="5" style="width:60px;padding:5px;background:#363636;color:#fff;border:1px solid #555;border-radius:4px"></div><div style="margin-top:10px"><button id="get-increment-btn" style="padding:8px 15px;background-color:#464646;color:#fff;border:none;border-radius:4px;cursor:pointer">顯示增量點</button></div></div><div class="search-buttons" style="margin-top:20px;text-align:right"><button id="map-point-close" style="padding:8px 15px;background-color:#363636;color:#fff;border:none;border-radius:4px;cursor:pointer">關閉</button></div></div></div></div><script type="module">import{AddBusInMap}from"./script/AddBusInMap.js";mapboxgl.accessToken="pk.eyJ1IjoicmF5d29uZ3N0dWR5IiwiYSI6ImNsOTUzaXBmajIzdXczd210a2s5dXM1anoifQ.2bzIw0cqaCbTmmDKP9DOxA",window.map=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/dark-v11",attributionControl:!1,center:["113.54884000","22.16185000"],zoom:13.5,pitch:30}),window.trafficIds,map.on("load",(()=>{setTimeout((()=>{document.getElementById("loading-screen").style.opacity="0",setTimeout((()=>{document.getElementById("loading-screen").style.display="none",startClock()}),500)}),1200),Add3DFunction(map),window.trafficIds=addRouteToMap(map,traffic_data,[]),console.log("路線已加載，共"+(window.trafficIds?window.trafficIds.length:0)+"条路线"),AddBusInMap(map,[],"https://api.minimacau3d.com/bus_location_data",traffic_data),AddCameraData(map,real_time_camera_data),AddStationInfo(map,"https://api.minimacau3d.com/bus_info",station_data,[]),getAndShowUserGps(map)}))</script><script defer="defer" src="bundle.69223f89cea728e28cd3.js"></script></body><script src="./script.js"></script><script>window.addEventListener("load",(function(){console.log("页面加载完成，检查current-time-box的可见性");const e=document.getElementById("current-time-box");if(e){console.log("current-time-box元素存在"),e.style.display="flex",e.style.zIndex="999";const t=new Date("2025-04-28 02:01:58");window.updateBusDateTime&&(console.log("手动触发updateBusDateTime测试"),window.updateBusDateTime(t))}else console.error("未找到current-time-box元素!")}))</script></html>