function successCallback(e){if(1==GetUserGpsRemark&&o!=e.coords.latitude&&r!=e.coords.longitude&&(r=e.coords.longitude,o=e.coords.latitude,user_gps_corrdinates=[r,o],geojsonSource=map.getSource("user_gps"),geojsonSource.setData({type:"FeatureCollection",features:[{type:"Feature",properties:{description:"<b>你所在的位置</b>"},geometry:{type:"Point",coordinates:user_gps_corrdinates}}]})),0==GetUserGpsRemark){var o=e.coords.latitude,r=e.coords.longitude;user_gps_corrdinates=[r,o],map.addSource("user_gps",{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{description:"<b>你所在的位置</b>"},geometry:{type:"Point",coordinates:user_gps_corrdinates}}]}}),map.addLayer({id:"user_gps",type:"circle",source:"user_gps",paint:{"circle-color":"red","circle-radius":10,"circle-stroke-width":2,"circle-stroke-color":"#fff","circle-opacity":.7}}),GetUserGpsRemark=1;const s=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1});map.on("mouseenter","user_gps",(e=>{map.getCanvas().style.cursor="pointer";const o=e.features[0].geometry.coordinates.slice(),r=e.features[0].properties.description;for(;Math.abs(e.lngLat.lng-o[0])>180;)o[0]+=e.lngLat.lng>o[0]?360:-360;s.setLngLat(o).setHTML(r).addTo(map)})),map.on("mouseleave","user_gps",(()=>{map.getCanvas().style.cursor="",s.remove()}))}}function errorCallback(e){}function getAndShowUserGps(e){navigator.geolocation&&navigator.geolocation.watchPosition(successCallback,errorCallback)}GetUserGpsRemark=0;